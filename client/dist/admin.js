"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();window.addEventListener("load",function(){function e(e,t,n){var i=document.createElement(e);return i.className=t,void 0!==n&&(i.dataset.directive=n),i}function t(e,t){if(e){var n=new l,i=new XMLHttpRequest;return i.open("POST",e,!0),i.setRequestHeader("Content-type","application/json"),i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE)if(200===i.status)try{n.resolve(JSON.parse(i.responseText))}catch(e){n.reject(e)}else n.reject(i.status)},i.send(JSON.stringify(t)),n}}var n="seams-admin-panel",i=n+"-title",s=n+"-content",a=n+"-input",r=n+"-save-btn",c=n+"-cancel-btn",l=function(){function e(){_classCallCheck(this,e),this.resolve=function(){},this.reject=function(){}}return _createClass(e,[{key:"then",value:function(e){return this.resolve=e,this}},{key:"catch",value:function(e){return this.reject=e,this}}]),e}(),o=function(){function l(){_classCallCheck(this,l),this.initialize(),this.hide()}return _createClass(l,[{key:"initialize",value:function(){this._panel=e("div",n),this._title=e("div",i),this._content=e("div",s);var t=e("div",n+"-btns");this._save=e("button",r),this._cancel=e("button",c),this._save.innerText="save",this._cancel.innerText="cancel",t.appendChild(this._save),t.appendChild(this._cancel),this._panel.appendChild(this._title),this._panel.appendChild(this._content),this._panel.appendChild(t),this._save.addEventListener("click",this.save.bind(this)),this._cancel.addEventListener("click",this.cancel.bind(this)),document.body.appendChild(this._panel)}},{key:"save",value:function(){var e={};for(var n in this._directives){e[this._directives[n]]=this.bind(this._currentElement,n)()}t(window.location.pathname,e),this.hide()}},{key:"cancel",value:function(){for(var e in this._previous)this.bind(this._currentElement,e)(this._previous[e]);this.hide()}},{key:"show",value:function(t,n){var i=this;this._panel.style="display:block",this._content.innerHTML="",this._currentElement=t,this._previous={},this._directives={};for(var s=function(s){var r=n[s],c=e("input",a,r),l=i.bind(t,r);i._previous[r]=c.value=l(),i._directives[r]=t.dataset[r],c.addEventListener("input",function(e){l(c.value)}),i._content.appendChild(c)},r=0;r<n.length;r++)s(r)}},{key:"hide",value:function(){this._panel.style="display:none"}},{key:"bind",value:function(e,t){return function(n){if(void 0===n)switch(t){case"content":return e.innerHTML;default:return e.getAttribute(t)}else switch(t){case"content":return e.innerHTML=n;default:return e.setAttribute(t,n),n}}}}]),l}(),u=function(){function e(){_classCallCheck(this,e),this._editor=new o,this.initialize()}return _createClass(e,[{key:"initialize",value:function(){for(var e=this,t=[],n=0,i=0;i<directives.length;i++)for(var s=directives[i],a=document.querySelectorAll("*[data-"+directives[i]+"]"),r=0;r<a.length;r++){var c=a[r];c.dataset.seamsId?t[c.dataset.seamsId].directives.push(s):(c.dataset.seamsId=n,t[n++]={$el:c,directives:[s]})}t.forEach(function(t){var n=t.$el,i=t.directives;n.addEventListener("click",function(t){e._editor.show(n,i),t.stopPropagation(),t.preventDefault()})})}}]),e}();new u});